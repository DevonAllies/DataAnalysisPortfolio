---
title: "Covid 19 Dataset"
author:
  - name: 'Devon Allies, BSc. Honours: Bioinformatics & Computational Biology'
    affiliations:
      - name: 'Github: DevonAllies'
        url: 'https://github.com/DevonAllies'
      - name: 'Connect on LinkedIn'
        url: 'https://www.linkedin.com/in/devonallies/'
bibliography: references.bib
csl: harvard-anglia-ruskin-university.csl
image: 'image_ccf77676.png'
license: 'CC BY 4.0'
---

## Introduction:

Coronavirus Disease 2019 (Covid-19) is a highly contagious infectious disease caused by the *SARS-CoV-2* virus, which emerged as a global pandemic in early 2020. It primarily spreads through respiratory particles and has impacted global health, economics and societies worldwide.

### Project Context and Motivation:

This Quarto document serves as a exercise in Exploratory Data Analysis (EDA), focusing on a critical public health data-set related to the Covid-19 pandemic. The data, sourced from a collaborative research effort, provides clinical insights into patient outcomes based on complete blood count (CBC) metrics [@Rahman2020COVID] .

### Data Source and Collection Methodology:

The data-set was compiled by a team of researches and medical professionals from Qatar University and Dhaka Medical College Hospital, Bangladesh. Data collection occurred between April 12 and August 31, 2020, at the Dhaka Medical College Hospital, following approval from the local Hospital Ethical Committee. This specific time frame places the data collection during a significant early phase of the pandemic [@Rahman2020COVID].

## Import modules & packages:

Analysis was conducted primarily using Python, leveraging key libraries from the scientific Python ecosystem: **pandas** [@reback2020pandas], **Numpy** [@harris2020array], **Seaborn** [@Waskom2021], **Matplotlib** [@Hunter:2007], and **SciPy** [@2020SciPy-NMeth].

For alternative R analysis, the comprehensive **tidyverse** package was loaded [@Wickham2019].

```{python}
#| label: python_modules

import pandas as pd
import numpy as np
import seaborn as sns
sns.set()
import matplotlib.pyplot as plt
import scipy.stats as stats
from scipy.stats import chi2_contingency, ttest_ind
```

```{r}
#| label: r_packages
#| warnings: false
#| message: false

library(tidyverse)

```

## Load data set:

This step involves loading the raw `COVID-19_CBC_Data.csv` file into a data structure using the `pandas` module. The `pd.read_csv()` function is used to read the data from the local file path into a DataFrame named `data` for subsequent analysis.

```{python}
#| label: load_data

data = pd.read_csv('COVID-19_CBC_Data.csv')
```

```{r}
#| label: r_data
#| echo: false

r_data <- read.csv('COVID-19_CBC_Data.csv')
```

## Data Scope and Key Variables:

The data-set captures clinical parameters, demographic data, and patient outcomes for a cohort of `103 patients`.

Key information includes standard CBC metrics, as well as critical outcomes variables: hospital admission status and final results, `Recovered or Not Recovered`. The data-set is relatively balanced regarding outcomes, with 61 patients surviving and 42 resulting in death.

The `data.head()` function is a standard initial step in EDA. It provides a quick, concise view of the top rows of the DataFrame, allowing us to inspect the data-set's structure, identify data types, and confirm the initial loading was successful.

```{python}
#| label: tbl-head-data
#| echo: false
#| tbl-cap: 'Preview Data'
#| tbl-pos: 'H'

preview_data = data[['Gender', 'White blood cell count', 'Platelet Count', 'Lymphocyte Count']].head(n=10)
print(preview_data.to_markdown(index=False))

```

This initial inspection confirms that the data has been loaded correctly and provides the foundational understanding required to proceed with more in-depth statistical analysis and visualization.

## Data Quality Assessment:

```{python}
#| label: tbl-missing-values
#| echo: false
#| tbl-cap: 'Summary of Missing Values per Column'
#| tbl-pos: 'H'

missing_values_summary = data.isnull().sum().reset_index()
missing_values_summary.columns = ['Column Name', 'Missing Count']
print(missing_values_summary.to_markdown(index=False))
```

The data-set demonstrates exceptional quality with zero missing values across all 18 features, including demographics, clinical metrics, and outcomes. This completeness eliminates pre-processing needs and enhances analysis reliability. @tbl-missing-values confirms full data availability for 103-patient cohort.

## Demographic Distributions:

### Patient Age Distribution:

```{python}
#| label: fig-age-distribution
#| echo: false
#| fig-cap: 'Histogram showing the distribution of patient ages within the dataset.'

sns.histplot(data, x = 'Patient Age')
plt.title('Distribution of Age')
plt.xlabel('Age')
plt.ylabel('Frequency')
plt.tight_layout()
_ = plt.show() # Silences the diagnostic text putput associated with the plot
```

@fig-age-distribution reveals a multimodal age distribution with peaks around 30-40, 50-60, and 60-70 years, spanning `{r} range(r_data$Patient.Age)` years overall. This middle-aged concentration reflects hospital admission patterns during early pandemic waves. Central tendency centers around `{r} median(r_data$Patient.Age)` years with moderate spread (SD $\pm$ `{r} round(sd(r_data$Patient.Age))`)

### Gender Composition:

```{python}
#| label: fig-gender-distribution
#| echo: false
#| warning: false
#| message: false
#| results: hide
#| fig-cap: 'Gender Distribution'
#| fig-pos: 'H'

plt.figure(figsize=(10,6))
ax = sns.countplot(data = data, x = 'Gender', palette='pastel')
ax.set_title('Gender Distribution')
ax.set_xlabel('Gender')
ax.set_ylabel('Count')
_ = plt.show()

```

Nearly balanced gender representation, `{r} sum(r_data$Gender == 'Male')` males, `{r} sum(r_data$Gender == 'Female')` females) minimizes sampling bias, as shown in @fig-gender-distribution. This equilibrium supports gender-stratified analyses without confounding by disproportionate representation.

### Survival Pattern Analysis:

#### Age-Survival Relationship:

```{python}
#| label: fig-age-survival-violin
#| echo: false
#| warning: false
#| message: false
#| results: hide
#| fig-cap: 'Age Survival Relationship'
#| fig-pos: 'H'

# 1. Violin plots for age-survival
plt.figure(figsize=(10, 6))
sns.violinplot(data=data, x='Outcome', y='Patient Age', palette='Set2')
plt.title('Age Distribution by Survival Outcome')
plt.show()
```

Violin plots, @fig-age-survival-violin, demonstrates clear age-outcome divergences: recovered patients peak at 30-50 years while non-recovered concentrate above 60 years. Survival rates decline sharply: 87%, \< 40 years, 57%, 40-60 years, and 24%, \> 60 years.

```{python}
#| label: tbl-age-survival
#| echo: false
#| message: false
#| warning: false
#| tbl-pos: 'H'
#| tbl-cap: 'Survival percentages per Age Group'

# Define custom bins 
age_bins = [-float('inf'), 40, 60, float('inf')]
age_labels = ['<40', '40-60', '>60']

# Create new Age group using the bins
data['Age Group'] = pd.cut(data['Patient Age'], bins=age_bins, labels=age_labels, right=False)

# Create summary table grouped by age
summary_df = data.groupby('Age Group')['Outcome'].value_counts(normalize=False).unstack(fill_value=0)

# Calculate the % and total
summary_df['n'] = summary_df['Recovered'] + summary_df['Not Recovered']
summary_df['Recovered %'] = (summary_df['Recovered'] / summary_df['n'] * 100).round(1)
summary_df['Not Recovered %'] = (summary_df['Not Recovered'] / summary_df['n'] * 100).round(1)

# Reorder the columns
final_summary = summary_df[['Recovered %', 'Not Recovered %', 'n']].reset_index()
print(final_summary.to_markdown(index = False))
```

### Clinical Outcomes by Gender:

#### Gender-Survival Association:

```{python}
#| label: fig-gender-survival
#| echo: false
#| warning: false
#| message: false
#| results: hide
#| fig-cap: 'Survival by Gender'

sns.countplot(data = data, x = 'Gender', hue = 'Outcome')
plt.title('Survival by Gender')
plt.xlabel('Gender')
plt.ylabel('Frequence')
plt.tight_layout()
_ = plt.show()
```

@fig-gender-survival shows proportional recovery rates ($\pm$ 59% overall) identical across genders despite higher raw non-recovery counts among males.

### Clinical Trajectory Metics:

#### Hospital Length Stay:

Length of Stay (LOS), @fig-los, reveal shorter median stays for recovered patients versus prolonged stays for non-recovered cases, reflecting disease severity.

```{python}
#| label: fig-los
#| echo: false
#| warning: false
#| message: false
#| results: hide
#| fig-cap: 'Length of Stay'
#| fig-pos: 'H'

# Convert date columns to datetime objects
data['Admission_DATE '] = pd.to_datetime(data['Admission_DATE '])
data['Discharge_DATE_or_date_of_Death'] = pd.to_datetime(data['Discharge_DATE or date of Death'])

# Calculate Length of Stay (LOS) in days
data['LOS_days'] = (data['Discharge_DATE_or_date_of_Death'] - data['Admission_DATE ']).dt.days


plt.figure(figsize=(8, 5))
sns.boxplot(x='Outcome', y='LOS_days', data=data)
plt.title('Length of Stay by Patient Outcome')
plt.ylabel('Days')
plt.xlabel('Outcome Status')
plt.tight_layout()
plt.show()
```

#### Ventilation and Treatment Analysis:

```{python}
#| label: tbl-vent
#| echo: false
#| warnings: false
#| message: false
#| tbl-pos: 'H'
#| tbl-cap: 'Ventilation and treatment analysis'

vent_table = pd.crosstab(data['Ventilated (Y/N)'], data['Outcome'], margins=True, normalize='index') * 100
print(vent_table.round(1).to_markdown())

# Treatment effects
treat_table = pd.crosstab(data['What kind of Treatment provided '], data['Outcome'], normalize='index') * 100
```

Ventilated patients showed a 70% mortality rate vs 35% mortality rate for the non-ventilated patients.

#### Clinical Variable Intercorrelations:

```{python}
#| echo: false

cbc_columns = [
    'White blood cell count', 'Platelet Count', 
    'Lymphocyte Count', 'Neutrophils Count'
]
```

```{python}
#| label: fig-heatmap
#| echo: false
#| warning: false
#| message: false
#| results: hide
#| fig-cap: 'Correlation Heatmap'
#| fig-pos: 'H'

num_cols = data.select_dtypes(include=['float64', 'int64']).columns
corr_matrix = data[num_cols].corr()

plt.figure(figsize=(12, 10))
sns.heatmap(corr_matrix, annot=True, cmap='coolwarm', center=0, 
            square=True, fmt='.2f')
plt.title('Complete Correlation Matrix of Clinical Variables')
plt.tight_layout()
plt.show()
```

The expanded heatmap, @fig-heatmap, highlights strongest relationships: `neutrophils - lymphocytes`. Notable absent: `age-outcome` correlation due to categorical target encoding. Weak age associations with blood metrics suggest independent demographic effects.

### Statistical Hypothesis Testing:

```{python}
#| echo: false

# 1. Chi-square test for gender-survival association
gender_survival_crosstab = pd.crosstab(data['Gender'], data['Outcome'])
chi2, p_value, dof, expected = chi2_contingency(gender_survival_crosstab)
print(f"Gender-Survival Chi-square: χ²={chi2:.2f}, p={p_value:.4f}")

# 2. T-test for age differences by outcome (using ttest_ind)
recovered_ages = data[data['Outcome'] == 'Recovered']['Patient Age']
not_recovered_ages = data[data['Outcome'] == 'Not Recovered']['Patient Age']
# Assuming equal variance for a standard independent t-test (default is True)
t_stat, p_age = ttest_ind(recovered_ages, not_recovered_ages)
print(f"Age by Outcome T-test: t={t_stat:.2f}, p={p_age:.4f}")
```

#### Chi-square test for gender-survival association:

A `Chi-square` test of independence was performed to examine the relationship between patient gender and survival outcome.

The analysis produced $x^2$ statistic of 2.68 with a corresponding p-value of 0.1016. Since the p-value is greater than the standard significance level of 0.05, we fail to reject the `null hyporhesis`, that gender and survival are independent.

The statistical evidence suggests there is **no significant association** between a patient's gender and their likelyhood of recovery within this specific data-set. This supports the visual observation from @fig-gender-distribution , indicating similar proportional outcomes for both males and females.

#### T-Test for age difference by outcome:

An **independent samples T-test** was conducted to compare the mean age of patients who recovered versus those who did not recover.

The T-test yielded a T-statistic of -6.90 and an extremely low p-value. As the p-value is well below the 0.05 significance threshold, we **reject the null hypothesis**.

The negative T-statistic indicates that patients who **recovered** were, on average, younger than those who did not recover. This provides support for @fig-age-survival-violin , highlighting age as a critical predictor of outcome in this cohort.

## Key Takeaways:

```{python}
#| echo: false

print("1. Age >60 years: 76% mortality risk (t=-6.90, p<0.0001, d=1.4)")
print("2. No missing data - excellent quality")
print("3. Multimodal age distribution (peaks: 30-40, 50-60, 60-70)")
print("4. Gender not significant predictor")
print('5. Ventilation: 70% case fatality rate vs 35% non-ventilated')

print("\n=== LIMITATIONS ===")
print("1. Small sample (n=103)")
print("2. Single hospital, early pandemic (Apr-Aug 2020)")
print("3. No treatment effect analysis")
print("4. Limited geographic representation")

```

### License and Data Usage Terms:

The data used in this analysis is provided under the [**Creative Commons Attribution 4.0 International License (CC BY 4.0)**](https://creativecommons.org/licenses/by/4.0/)**.**

## References
